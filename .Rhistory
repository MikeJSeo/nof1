#json.file <- fromJSON("sample input-missing baseline.json")
#json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
data <- json.file$data
metadta <- json.file$metadata
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
metadata <- json.file$metadata
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
library(nof1)
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
washout <- function(read_data){
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-5]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
delete_obs_weekly <- NULL
for(i in 1:length(change_point2)){
delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
}
stool_consistency[delete_obs_daily] <- NA
stool_frequency[delete_obs_daily] <- NA
pain_interference[delete_obs_weekly] <- NA
gi_symptoms[delete_obs_weekly] <- NA
list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
}
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
data <- json.file$data
metadata <- json.file$metadata
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
read_data
str(read_data)
data
if(metadata$user_age < 14){
Outcome <- data$parent_response
}else{
if(sum(is.na(data$parent_response)) < sum(is.na(data$child_response))){
Outcome <- data$parent_response
}else{
Outcome <- data$child_response
}
}
Treatment <- data[,"treatment"]
Treatment <- unlist(Treatment)
Treatment[Treatment == "strict"] = "A"
Treatment[Treatment == "liberalized"] = "B"
Treatment
length_each <- sapply(Outcome[,"daily_stool_consistency"], length)
length_each
cumsum(length_each)
Treatment
Treatment <- data[,"treatment"]
Treatment <- unlist(Treatment)
Treatment[Treatment == "strict"] = "A"
Treatment[Treatment == "liberalized"] = "B"
length_each <- sapply(Outcome[,"daily_stool_consistency"], length)
Treat <- rep(Treatment, times = length_each)
Treatment
seq(1, length(Treatment), 7)
Treatment_weekly <- Treatment[seq(1, length(Treatment), 7)]
Treatment_weekly
Treatment <- data[,"treatment"]
Treatment <- unlist(Treatment)
Treatment[Treatment == "strict"] = "A"
Treatment[Treatment == "liberalized"] = "B"
Treatment
help(seq)
Treat
Treatement
Treatement
Treatment
Treatment
data[,"treatment"]
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
str(read_data)
library(jsonlite)
library(nof1)
json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
#json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
#result <- do.call(wrap, json.file)
#output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
#output
json.file
data <-json.file$data
metadata <- json.file$metadata
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
str(read_data)
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
#result <- do.call(wrap, json.file)
#output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
#output
data <- json.file$data
metadata <- json.file$metadata
read_data <- tryCatch({
read_dummy <- read_input_data(data, metadata)
washout(read_dummy)
}, error = function(error){
return(paste("input read error: ", error))
})
read_data
str(read_data)
if(metadata$user_age < 14){
Outcome <- data$parent_response
}else{
if(sum(is.na(data$parent_response)) < sum(is.na(data$child_response))){
Outcome <- data$parent_response
}else{
Outcome <- data$child_response
}
}
Treatment <- data[,"treatment"]
Treatment <- unlist(Treatment)
Treatment[Treatment == "strict"] = "A"
Treatment[Treatment == "liberalized"] = "B"
length_each <- sapply(Outcome[,"daily_stool_consistency"], length)
Treat <- rep(Treatment, times = length_each)
Treat
Treatment
Outcome
str(read_input_data(data, metadata)
)
read_data <- read_input_data(data, metadata)
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-5]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-5]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-5]
change_point
# delete_obs_daily <- NULL
# for(i in 1:length(change_point)){
#   delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
# }
# delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
cumsum(rle(Treatment)$lengths)
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point
# delete_obs_daily <- NULL
# for(i in 1:length(change_point)){
#   delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
# }
# delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-rle(Treatment)$lengths]
change_point
# delete_obs_daily <- NULL
# for(i in 1:length(change_point)){
#   delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
# }
# delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
change_point
# delete_obs_daily <- NULL
# for(i in 1:length(change_point)){
#   delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
# }
# delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)
change_point2 <- change_point[-length(change_point2)]
delete_obs_weekly <- NULL
for(i in 1:length(change_point2)){
delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
}
stool_consistency[delete_obs_daily] <- NA
stool_frequency[delete_obs_daily] <- NA
pain_interference[delete_obs_weekly] <- NA
gi_symptoms[delete_obs_weekly] <- NA
list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
str(with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)[-5]
change_point
# delete_obs_daily <- NULL
# for(i in 1:length(change_point)){
#   delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
# }
# delete_obs_daily
# change_point2 <- cumsum(rle(Treatment_weekly)$lengths)[-5]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
#
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
)
str(  with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)
change_point2 <- change_point[-length(change_point2)]
delete_obs_weekly <- NULL
for(i in 1:length(change_point2)){
delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
}
stool_consistency[delete_obs_daily] <- NA
stool_frequency[delete_obs_daily] <- NA
pain_interference[delete_obs_weekly] <- NA
gi_symptoms[delete_obs_weekly] <- NA
list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
}))
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)
change_point2 <- change_point[-length(change_point2)]
delete_obs_weekly <- NULL
for(i in 1:length(change_point2)){
delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
}
delete_obs_weekly
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)
change_point2
# change_point2 <- change_point[-length(change_point2)]
# delete_obs_weekly <- NULL
# for(i in 1:length(change_point2)){
#   delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
# }
# delete_obs_weekly
# stool_consistency[delete_obs_daily] <- NA
# stool_frequency[delete_obs_daily] <- NA
# pain_interference[delete_obs_weekly] <- NA
# gi_symptoms[delete_obs_weekly] <- NA
#list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
washout <- function(read_data){
with(read_data,{
change_point <- cumsum(rle(Treatment)$lengths)
change_point <- change_point[-length(change_point)]
delete_obs_daily <- NULL
for(i in 1:length(change_point)){
delete_obs_daily <- c(delete_obs_daily, (change_point[i]+1):(change_point[i]+7))
}
delete_obs_daily
change_point2 <- cumsum(rle(Treatment_weekly)$lengths)
change_point2 <- change_point2[-length(change_point2)]
delete_obs_weekly <- NULL
for(i in 1:length(change_point2)){
delete_obs_weekly <- c(delete_obs_weekly, (change_point2[i]+1))
}
delete_obs_weekly
stool_consistency[delete_obs_daily] <- NA
stool_frequency[delete_obs_daily] <- NA
pain_interference[delete_obs_weekly] <- NA
gi_symptoms[delete_obs_weekly] <- NA
list(Treatment = Treatment, Treatment_weekly = Treatment_weekly, stool_consistency = stool_consistency, stool_frequency = stool_frequency, pain_interference = pain_interference, gi_symptoms = gi_symptoms)
})
}
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
read_dummy <- read_input_data(data, metadata)
read_dummy
washout(read_dummy)
remove(list = ls())
library(jsonlite)
library(nof1)
#json.file <- fromJSON("sample input.json")
#json.file <- fromJSON("sample input-with some NA.json")
#json.file <- fromJSON("sample input-same data.json")
#json.file <- fromJSON("sample input-missing baseline.json")
json.file <- fromJSON("sample input-minimum data.json")
#json.file <- fromJSON("sample input-inverse.json")
result <- do.call(wrap, json.file)
output <- toJSON(result, pretty = TRUE, UTC = TRUE, auto_unbox = TRUE)
output
